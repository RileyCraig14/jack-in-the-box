<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>🎁 Jack Pop Pro</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    * { box-sizing:border-box; margin:0; padding:0 }
    :root {
      --bg: #121212;
      --fg: #e0e0e0;
      --accent: #ff9800;
      --card: #1f1f1f;
      --rake: 0.05;
      --max-width: 600px;
    }
    html, body {
      height:100%; font-family:sans-serif;
      background: var(--bg);
      color: var(--fg);
      display:flex; align-items:center; justify-content:center;
    }
    .container {
      width: 90%;
      max-width: var(--max-width);
      background: var(--card);
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
      overflow: hidden;
    }
    header {
      background: var(--accent);
      padding: 1rem;
      text-align:center;
      font-family: 'Press Start 2P', monospace;
      font-size: 1.1rem;
      color: #121212;
    }
    footer {
      background: #181818;
      padding: 0.6rem;
      font-size: 0.7rem;
      text-align: center;
      color: #777;
    }
    .screen { display: none; padding: 1rem; }
    .active { display: block; }
    .card { background: #232323; border-radius:8px; padding:1rem; margin: 1rem 0; }
    h2 { font-family: 'Press Start 2P', monospace; font-size:1rem; margin-bottom:0.5rem; }
    button, input[type="checkbox"] { cursor: pointer; }
    input[type="checkbox"] { transform: scale(1.2); margin-right:0.5rem; }
    .link { color: var(--accent); cursor:pointer; text-decoration:underline; }
    .btn {
      display:inline-block;
      background: var(--accent);
      color: #121212;
      border:none;
      border-radius:30px;
      padding: 0.6rem 1rem;
      font-family: 'Press Start 2P', monospace;
      font-size:0.75rem;
      margin:0.5rem 0;
      box-shadow: 0 0 6px rgba(255,152,0,0.7);
      transition: transform .15s, box-shadow .15s;
    }
    .btn:hover:not(:disabled) { transform: scale(1.05); box-shadow:0 0 16px var(--accent); }
    .btn:disabled { opacity:0.4; box-shadow:none; cursor:default; }
    #controls { display:flex; flex-wrap: wrap; gap:1rem; align-items:center; justify-content:center; }
    #controls label { display:flex; align-items:center; }
    #mult { text-align:center; font-size:2.5rem; margin:0.5rem 0; font-family: 'Press Start 2P', monospace; }
    .game-area { position:relative; width:100%; padding-top:56%; }
    #head {
      position:absolute; bottom:0; left:50%;
      width:80px; height:80px;
      margin-left:-40px;
      background: radial-gradient(circle at 30% 30%, #ff7043, #d84315);
      border-radius:50%;
      box-shadow: 0 8px 12px rgba(0,0,0,0.5);
      transform: translateY(100%);
      transition: transform 0.1s linear;
    }
    .progress-bar {
      width:100%; height:8px;
      background: #333; border-radius:4px;
      overflow:hidden; margin-top:0.5rem;
    }
    .progress-bar > div {
      width:0%; height:100%; background: var(--accent);
      transition: width 0.1s linear;
    }
    @media (max-width: 400px) {
      #head { width:60px; height:60px; margin-left:-30px; }
      .btn { font-size:0.6rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>🎁 Jack Pop Pro</header>
    <!-- AGE GATE -->
    <div id="ageGate" class="screen active">
      <div class="card">
        <h2>☑️ AGE VERIFICATION</h2>
        <label><input type="checkbox" id="ageCheck"> I am 18+ and agree to virtual currency only.</label>
        <button class="btn" id="ageNext" disabled>CONTINUE</button>
      </div>
    </div>
    <!-- LOGIN -->
    <div id="login" class="screen">
      <div class="card">
        <h2>🔑 ENTER USERNAME</h2>
        <input type="text" id="username" placeholder="Your name" />
        <button class="btn" id="loginBtn">ENTER LOBBY</button>
      </div>
    </div>
    <!-- LOBBY -->
    <div id="lobby" class="screen">
      <div class="card">
        <h2>🏠 LOBBY</h2>
        <p>Welcome, <strong id="labelUser"></strong></p>
        <p>Balance: 🪙<span id="balance">0</span></p>
        <button class="btn" id="toGame">PLAY</button>
        <button class="btn" id="toRules">RULES</button>
      </div>
    </div>
    <!-- RULES -->
    <div id="rules" class="screen">
      <button class="btn link" id="backRules">← BACK</button>
      <div class="card">
        <h2>📖 HOW TO PLAY</h2>
        <ul>
          <li>Bet 1 coin per round (auto-deducted).</li>
          <li>Click <strong>POP!</strong> before the head pops.</li>
          <li>Multiplier grows +0.5×/s. Crash at 2–30 s.</li>
          <li>Payout = <code>1×multiplier×(1−5% rake)</code>.</li>
        </ul>
      </div>
    </div>
    <!-- GAME -->
    <div id="game" class="screen">
      <button class="btn link" id="quitGame">← LOBBY</button>
      <div id="mult">1.00×</div>
      <div class="game-area">
        <div id="head"></div>
      </div>
      <div class="progress-bar"><div></div></div>
      <div id="controls">
        <button class="btn" id="startBtn">START</button>
        <button class="btn" id="popBtn" disabled>POP!</button>
      </div>
    </div>
    <footer>
      ©2025 Jack Pop Pro — Virtual coins only • 5% house rake • 18+ • Play responsibly  
    </footer>
  </div>
  <script>
  // ── State ─────────────────────────────────────────────────────────────────
  let running=false, startT=0, crashT=0, balance=100, high=1, mult=1;
  const rake = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--rake'));
  // ── DOM Refs ───────────────────────────────────────────────────────────────
  const screens = ['ageGate','login','lobby','rules','game'];
  const show = id => {
    screens.forEach(s=>document.getElementById(s).classList.remove('active'));
    document.getElementById(id).classList.add('active');
  };
  const ageCheck = document.getElementById('ageCheck'),
        ageNext  = document.getElementById('ageNext'),
        loginBtn = document.getElementById('loginBtn'),
        userIn   = document.getElementById('username'),
        labelU   = document.getElementById('labelUser'),
        balEl    = document.getElementById('balance'),
        multEl   = document.getElementById('mult'),
        head     = document.getElementById('head'),
        bar      = document.querySelector('.progress-bar > div'),
        startBtn = document.getElementById('startBtn'),
        popBtn   = document.getElementById('popBtn'),
        toRules  = document.getElementById('toRules'),
        backRules= document.getElementById('backRules'),
        toGame   = document.getElementById('toGame'),
        quitGame = document.getElementById('quitGame');
  // ── Age Gate ───────────────────────────────────────────────────────────────
  ageCheck.onchange = ()=> ageNext.disabled = !ageCheck.checked;
  ageNext.onclick    = ()=> show('login');
  // ── Login ─────────────────────────────────────────────────────────────────
  loginBtn.onclick = ()=>{
    const name = userIn.value.trim();
    if(!name) return alert('Enter a username');
    labelU.textContent = name;
    balEl.textContent  = balance;
    show('lobby');
  };
  // ── Navigation ────────────────────────────────────────────────────────────
  toRules.onclick = ()=> show('rules');
  backRules.onclick = ()=> show('lobby');
  toGame.onclick  = ()=> show('game');
  quitGame.onclick= ()=> show('lobby');
  // ── Game Logic ────────────────────────────────────────────────────────────
  function rndTime(){ return 2 + Math.random()*28; }
  function startRound(){
    if(running) return;
    if(balance < 1) return alert('Not enough coins');
    balance--; balEl.textContent=balance;
    crashT = rndTime(); startT = performance.now();
    running = true;
    startBtn.disabled = true; popBtn.disabled=false;
    requestAnimationFrame(loop);
  }
  function settle(cashed){
    const elapsed = (performance.now()-startT)/1000;
    const m = 1 + Math.min(elapsed, crashT)*0.5;
    if(cashed && elapsed<crashT){
      const payout = Math.floor(1*m*(1-rake));
      balance += payout;
      alert(`You popped at ${m.toFixed(2)}× and won ${payout} coins!`);
      high = Math.max(high,m);
    } else {
      if(!cashed) alert('Too late—the head popped!');
    }
    balEl.textContent = balance;
    running=false;
    startBtn.disabled=false; popBtn.disabled=true;
  }
  startBtn.onclick = ()=> startRound();
  popBtn.onclick   = ()=> running && settle(true);
  function loop(ts){
    if(!running) return;
    const elapsed = (ts-startT)/1000;
    mult = 1 + elapsed*0.5;
    multEl.textContent = mult.toFixed(2)+'×';
    // update head & bar
    const p = Math.min(1, elapsed/crashT);
    head.style.transform = `translateY(${100 - p*100}%)`;
    bar.style.width = `${p*100}%`;
    if(elapsed>=crashT){
      settle(false);
      return;
    }
    requestAnimationFrame(loop);
  }
  </script>
</body>
</html> 